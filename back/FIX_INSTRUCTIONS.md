# 🔧 הוראות תיקון שגיאת soldier_status.start_date

## 📋 תיאור הבעיה

השגיאה שקיבלת:
```
sqlite3.OperationalError: no such column: soldier_status.start_date
```

זו שגיאה שנובעת מכך שטבלת `soldier_status` במסד הנתונים חסרות העמודות `start_date` ו-`end_date` שהמודל מצפה שיהיו.

## ✅ פתרון הבעיה

### אפשרות 1: הרצת הסקריפט המשופר (מומלץ)

1. **עצור את השרת** (אם הוא רץ)

2. **פתח terminal/cmd** בתיקייה `back` של הפרויקט:
   ```
   cd C:\Users\gal31\מסמכים\GitHub\shavzak\back
   ```

3. **הרץ את סקריפט התיקון**:
   ```
   python fix_soldier_status_schema.py
   ```

4. **אם הסקריפט עבר בהצלחה**, תראה הודעה:
   ```
   ✅ התיקון הושלם בהצלחה!
   ```

5. **הפעל מחדש את השרת**

### אפשרות 2: הרצת הסקריפט הקיים

אם אפשרות 1 לא עובדת, נסה להריץ את הסקריפט הקיים:
```
python update_db.py
```

או:
```
python migrate_soldier_status.py
```

## 🛡️ גיבוי מסד הנתונים

הסקריפט `fix_soldier_status_schema.py` יוצר **גיבוי אוטומטי** של מסד הנתונים לפני ביצוע השינויים.

הגיבוי יישמר בשם: `shavzak.db.backup_YYYYMMDD_HHMMSS`

אם משהו משתבש, תוכל לשחזר את הגיבוי על ידי:
```
copy shavzak.db.backup_YYYYMMDD_HHMMSS shavzak.db
```

## 📊 מה הסקריפט עושה?

1. ✅ בודק אילו עמודות קיימות בטבלת `soldier_status`
2. ✅ יוצר גיבוי אוטומטי של מסד הנתונים
3. ✅ מוסיף את העמודות החסרות:
   - `start_date` (DATE)
   - `end_date` (DATE)
4. ✅ מאמת שהעמודות נוספו בהצלחה
5. ✅ מדפיס סיכום מפורט של הפעולות שבוצעו

## 🆘 אם משהו לא עובד

### בעיה: "לא נמצא קובץ מסד הנתונים"

**פתרון:**
- ודא שאתה רץ מהתיקייה הנכונה (`back/`)
- בדוק איפה נמצא קובץ `shavzak.db`
- אם הוא במיקום אחר, הרץ:
  ```
  python fix_soldier_status_schema.py נתיב\למסד\נתונים\shavzak.db
  ```

### בעיה: "Permission denied"

**פתרון:**
- עצור את השרת לפני הרצת הסקריפט
- ודא שאף תוכנה אחרת לא משתמשת במסד הנתונים

### בעיה: "module not found"

**פתרון:**
- ודא שאתה ב-virtual environment הנכון
- הפעל:
  ```
  pip install -r requirements.txt
  ```

## 📝 הערות חשובות

- ⚠️ **חשוב לעצור את השרת** לפני הרצת הסקריפט
- ✅ הסקריפט יוצר גיבוי אוטומטי - אין סיכון לאבד נתונים
- ✅ אם העמודות כבר קיימות, הסקריפט לא ישנה כלום
- ✅ הסקריפט בטוח להרצה מספר פעמים

## 🎯 אחרי התיקון

1. הפעל מחדש את השרver
2. בדוק שהשגיאה נעלמה
3. אם יש בעיות נוספות, בדוק את ה-logs

---

**נוצר בתאריך:** 2025-11-18
**סקריפט תיקון:** `fix_soldier_status_schema.py`
**גרסה:** 1.0
