import{u as C,r as i,b as p,Q as o,j as e,S as y}from"./index-MGr0sPC9.js";import{P as S,a as w}from"./plus-BHkSYOlI.js";const P=()=>{const{user:r,updateUser:g}=C(),[s,h]=i.useState(null),[b,x]=i.useState(!0),[m,d]=i.useState(!1),[t,c]=i.useState({name:"",gdud:"",color:"#34996e"});i.useEffect(()=>{j()},[r==null?void 0:r.pluga_id]);const j=async()=>{var a;if(!(r!=null&&r.pluga_id)){x(!1);return}try{const l=(a=(await p.get(`/plugot/${r.pluga_id}`)).data)==null?void 0:a.pluga;l&&(h(l),c({name:l.name||"",gdud:l.gdud||"",color:l.color||"#FFFFFF"})),x(!1)}catch(n){console.error("Error loading pluga:",n),o.error("שגיאה בטעינת פרטי הפלוגה"),x(!1)}},v=async a=>{var n,l,f;a.preventDefault();try{if(s)await p.put(`/plugot/${s.id}`,t),o.success("הפלוגה עודכנה בהצלחה");else{const u=(n=(await p.post("/plugot",t)).data)==null?void 0:n.pluga;u&&(h(u),typeof g=="function"&&g({pluga_id:u.id})),o.success("הפלוגה נוצרה בהצלחה")}d(!1),j()}catch(N){o.error(((f=(l=N.response)==null?void 0:l.data)==null?void 0:f.error)||"שגיאה בשמירה")}};return b?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"spinner"})}):!s&&!m?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(y,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"אין פלוגה במערכת"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"צור פלוגה חדשה להתחלת העבודה"}),e.jsxs("button",{onClick:()=>d(!0),className:"btn-primary flex items-center gap-2 mx-auto",children:[e.jsx(S,{size:20}),e.jsx("span",{children:"צור פלוגה"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"ניהול הפלוגה"}),s&&!m&&e.jsxs("button",{onClick:()=>d(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(w,{size:20}),e.jsx("span",{children:"ערוך"})]})]}),m?e.jsx("div",{className:"card",children:e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"שם הפלוגה"}),e.jsx("input",{type:"text",value:t.name,onChange:a=>c({...t,name:a.target.value}),className:"input-field",required:!0,placeholder:"פלוגה ב"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"גדוד"}),e.jsx("input",{type:"text",value:t.gdud,onChange:a=>c({...t,gdud:a.target.value}),className:"input-field",placeholder:"גדוד פנתר"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"צבע"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"color",value:t.color,onChange:a=>c({...t,color:a.target.value}),className:"w-16 h-10 rounded cursor-pointer"}),e.jsx("input",{type:"text",value:t.color,onChange:a=>c({...t,color:a.target.value}),className:"input-field flex-1"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",className:"btn-primary",children:"שמור"}),e.jsx("button",{type:"button",onClick:()=>d(!1),className:"btn-secondary",children:"ביטול"})]})]})}):e.jsxs("div",{className:"card",style:{borderTop:`4px solid ${s.color}`},children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"bg-military-100 p-4 rounded-xl",style:{backgroundColor:`${s.color}20`},children:e.jsx(y,{className:"w-12 h-12",style:{color:s.color}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:s.name}),e.jsx("p",{className:"text-gray-600",children:s.gdud})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 pt-6 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"מחלקות"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.mahalkot_count||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"צבע זיהוי"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded",style:{backgroundColor:s.color}}),e.jsx("p",{className:"font-mono text-sm text-gray-700",children:s.color})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"סטטוס"}),e.jsx("span",{className:"badge badge-green",children:"פעיל"})]})]})]})]})};export{P as default};
