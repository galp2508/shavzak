import{c as Fe,u as ze,r as o,b as N,Q as h,j as e,S as Ee,U as ne}from"./index-MGr0sPC9.js";import{u as Me,a as oe,B as M,Z as Re,C as Ue,b as $e,R as q,D as De,T as Le,c as ie,d as ce,e as Be,f as Pe,S as Te,h as Oe,A as He,g as Ke,i as Ge,j as qe,k as Ze,s as Qe,K as We,P as Ye,l as Je,m as Ve}from"./AssignmentModal-DjieZupz.js";import{A as Xe}from"./award-BWTUxwiz.js";import{a as Z}from"./plus-BHkSYOlI.js";import{C as es}from"./clock-B-QKeR0s.js";import"./trash-2-iSZ9G9z-.js";import"./calendar-C4Y2KWCB.js";import"./save-JpyDqU2L.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=Fe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),ss=({name:a})=>{const{attributes:i,listeners:g,setNodeRef:l,transform:p,transition:v}=Je({id:a}),y={transform:Ve.Transform.toString(p),transition:v,cursor:"grab",touchAction:"none"};return e.jsx("div",{ref:l,style:y,...i,...g,className:"flex-1 min-w-[200px] font-bold text-center p-2 bg-gray-100 border-l border-gray-300 select-none hover:bg-gray-200 active:cursor-grabbing",children:a})},xs=()=>{var se,te,ae,re;const{user:a}=ze(),[i,g]=o.useState(null),[l,p]=o.useState(null),[v,y]=o.useState([]),[w,m]=o.useState(!0),[u,R]=o.useState(null),[U,W]=o.useState(!1),[$,Y]=o.useState(!1),[D,de]=o.useState(null),[L,me]=o.useState(null),[xe,J]=o.useState(!1),[he,_]=o.useState(!1),[k,I]=o.useState(null),[F,B]=o.useState(null),[A,z]=o.useState(null),[ue,P]=o.useState(!1),[pe,T]=o.useState(null),[ge,V]=o.useState([]),fe=Me(oe(Ye,{activationConstraint:{distance:8}}),oe(We,{coordinateGetter:Qe})),be=s=>{const{active:t,over:r}=s;t.id!==r.id&&V(n=>{const x=n.indexOf(t.id),f=n.indexOf(r.id);return Ze(n,x,f)})},je=async()=>{const s=document.getElementById("schedule-grid");if(s)try{const t=await qe(s,{scale:2,useCORS:!0,backgroundColor:"#ffffff"}),r=document.createElement("a");r.download=`shavzak-${i.toISOString().split("T")[0]}.png`,r.href=t.toDataURL("image/png"),r.click(),h.success("×”×ª××•× ×” × ×©××¨×” ×‘×”×¦×œ×—×”!")}catch(t){console.error("Export error:",t),h.error("×©×’×™××” ×‘×™×™×¦×•× ×”×ª××•× ×”")}};o.useEffect(()=>{console.log("ğŸ‘¤ User object:",a),console.log("ğŸ‘¤ User role:",a==null?void 0:a.role),console.log("âœ… Should show AI button?",(a==null?void 0:a.role)==="××¤"||(a==null?void 0:a.role)==="××"||(a==null?void 0:a.role)==="××›")},[a]),o.useEffect(()=>{const s=new Date;s.setDate(s.getDate()+1),g(s),we(),C()},[]),o.useEffect(()=>{i&&S(i)},[i]),o.useEffect(()=>{if(l!=null&&l.assignments){const s=[...new Set(l.assignments.map(t=>t.name))].sort();V(t=>{const r=s.filter(x=>!t.includes(x));return[...t.filter(x=>s.includes(x)),...r]})}},[l]),o.useEffect(()=>{const s=t=>{t.key==="ArrowRight"?E(-1):t.key==="ArrowLeft"&&E(1)};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[i]);const we=async()=>{try{const s=await N.get(`/plugot/${a.pluga_id}/mahalkot`);y(s.data.mahalkot||[])}catch(s){console.error("Error loading mahalkot:",s)}},C=async()=>{try{const s=await N.get("/ml/stats");R(s.data.stats)}catch(s){console.error("Error loading ML stats:",s)}},S=async s=>{var t,r;m(!0);try{const n=s.toISOString().split("T")[0],x=await N.get(`/plugot/${a.pluga_id}/live-schedule?date=${n}`);p(x.data),x.data.shavzak_id&&de(x.data.shavzak_id)}catch(n){h.error(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.error)||"×©×’×™××” ×‘×˜×¢×™× ×ª ×©×™×‘×•×¥"),console.error("Load schedule error:",n)}finally{m(!1)}},X=async()=>{var s,t;if(window.confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×™×¦×•×¨ ×©×™×‘×•×¥ ×—×›× ×¢× AI ×œ×™×•××™×™× ×”×‘××™×?")){Y(!0);try{const r=new Date(i),n=await N.post("/ml/smart-schedule",{pluga_id:a.pluga_id,start_date:r.toISOString().split("T")[0],days_count:2});n.data.failed_assignments&&n.data.failed_assignments.length>0?h.warning(`âš ï¸ ${n.data.message} - ${n.data.success_rate} ×”×¦×œ×™×—×•`):h.success(`ğŸ¤– ${n.data.message}`),await S(i),C()}catch(r){h.error(((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.error)||"×©×’×™××” ×‘×™×¦×™×¨×ª ×©×™×‘×•×¥ ×—×›×"),console.error("Smart schedule error:",r)}finally{Y(!1)}}},O=async(s,t,r=null)=>{var n,x;try{if(t==="rejected"&&!r){T(s),P(!0);return}const f={assignment_id:s,shavzak_id:D,rating:t,enable_auto_regeneration:!1};r&&(f.changes={feedback_text:r});const c=await N.post("/ml/feedback",f);if(h.success(c.data.message),t==="rejected"){const b=((n=l==null?void 0:l.assignments)==null?void 0:n.find(d=>d.id===s))||((x=l==null?void 0:l.schedules)==null?void 0:x.flatMap(d=>d.assignments||[]).find(d=>d.id===s));b&&(I(b),setTimeout(()=>{_(!0)},500),h.info("ğŸ’¡ ×¤×ª×—×ª×™ ×¢×‘×•×¨×š ××ª ×—×œ×•×Ÿ ×”×¢×¨×™×›×” - ×©×‘×¥ ×™×“× ×™×ª ×›×“×™ ×©×”××¢×¨×›×ª ×ª×œ××“!",{autoClose:3e3}))}await S(i),C()}catch(f){h.error("×©×’×™××” ×‘×©××™×¨×ª ×¤×™×“×‘×§"),console.error("Feedback error:",f)}},Ne=async()=>{try{const s=k||F;s&&await N.post("/ml/feedback",{assignment_id:s.id,shavzak_id:D,rating:"modified",changes:{feedback_text:k?"×”××©×ª××© ×“×—×” ××ª ×”×©×™×‘×•×¥ ×•××– ×¢×¨×š ××•×ª×• ×™×“× ×™×ª - ×œ×™××•×“ ××”×¢×¨×™×›×”":"×”××©×ª××© ×¢×¨×š ××ª ×”×©×™×‘×•×¥ ×™×“× ×™×ª - ×œ×™××•×“ ××”×¢×¨×™×›×”"}}),h.success("âœ… ×©×™×‘×•×¥ × ×©××¨ ×‘×”×¦×œ×—×”!"),_(!1),I(null),B(null),S(i),C()}catch(s){h.error("×©×’×™××” ×‘×©×œ×™×—×ª ×¤×™×“×‘×§"),console.error("Manual assignment error:",s)}},ve=(s,t)=>{t.stopPropagation(),A?A.id===s.id?(z(null),h.info("×”×‘×—×™×¨×” ×‘×•×˜×œ×”",{icon:"âŒ"})):ye(A,s):(z(s),h.info(`× ×‘×—×¨×” ××©×™××”: ${s.name}. ×œ×—×¥ ×¢×œ ×›×¤×ª×•×¨ ×”×—×œ×¤×” ×‘××©×™××” × ×•×¡×¤×ª`,{autoClose:3e3,icon:"ğŸ”„"}))},ye=async(s,t)=>{var r,n;try{const x=[{id:s.id,start_hour:t.start_hour,name:t.name},{id:t.id,start_hour:s.start_hour,name:s.name}];await Promise.all(x.map(f=>N.patch(`/assignments/${f.id}/time`,{start_hour:f.start_hour,name:f.name}))),h.success("×”××©×™××•×ª ×”×•×—×œ×¤×• ×‘×”×¦×œ×—×”! ğŸ”„",{icon:"âœ…"}),z(null),S(i)}catch(x){console.error("Error swapping assignments:",x),h.error(((n=(r=x.response)==null?void 0:r.data)==null?void 0:n.error)||"×©×’×™××” ×‘×”×—×œ×¤×ª ×”××©×™××•×ª"),z(null)}},E=s=>{const t=new Date(i);t.setDate(t.getDate()+s),g(t)},Se=s=>{const t=v.find(r=>r.id===s);return(t==null?void 0:t.color)||"#6B7280"},ke=s=>{const t=s.soldiers||[];if(t.length===0)return"#FBBF24";const r=new Set(t.map(n=>n.mahlaka_id).filter(n=>n!=null));if(r.size>=2)return"#FBBF24";if(r.size===1){const n=Array.from(r)[0];return Se(n)}return"#FBBF24"},ee=s=>["×¨××©×•×Ÿ","×©× ×™","×©×œ×™×©×™","×¨×‘×™×¢×™","×—××™×©×™","×©×™×©×™","×©×‘×ª"][s.getDay()];return w&&!l?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"card bg-gradient-to-br from-purple-600 via-blue-600 to-indigo-700 text-white shadow-2xl border-none p-4 md:p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[e.jsx("div",{className:"bg-white bg-opacity-20 p-3 rounded-2xl backdrop-blur-sm hidden md:block",children:e.jsx(M,{className:"w-12 h-12 animate-pulse"})}),e.jsxs("div",{className:"flex-1 text-center md:text-right",children:[e.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-3",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"×©×™×‘×•×¥ ×—×›× AI"}),e.jsxs("span",{className:"bg-green-500 text-white text-xs px-3 py-1 rounded-full font-bold animate-pulse flex items-center gap-1",children:[e.jsx(Re,{size:12}),"POWERED BY ML"]})]}),e.jsx("p",{className:"text-purple-100 text-sm md:text-lg font-medium hidden md:block",children:"×œ××™×“×ª ××›×•× ×” - ××©×ª×¤×¨ ×¢× ×”×–××Ÿ"})]})]}),e.jsxs("div",{className:"flex items-center justify-between w-full md:w-auto gap-4 bg-white bg-opacity-20 backdrop-blur-md rounded-2xl p-2 md:p-4 shadow-lg",children:[e.jsx("button",{onClick:()=>E(-1),className:"p-2 md:p-3 hover:bg-white hover:bg-opacity-30 rounded-xl transition-all duration-300 hover:scale-110 transform",title:"×™×•× ×§×•×“× (××§×© ×—×¥ ×™××™× ×”)",children:e.jsx(Ue,{size:24,className:"md:w-7 md:h-7"})}),e.jsxs("div",{className:"text-center min-w-[120px] md:min-w-[220px]",children:[e.jsx("div",{className:"text-xl md:text-3xl font-bold tracking-wide",children:i&&ee(i)}),e.jsx("div",{className:"text-sm md:text-base opacity-90 font-medium mt-1",children:i&&i.toLocaleDateString("he-IL")})]}),e.jsx("button",{onClick:()=>E(1),className:"p-2 md:p-3 hover:bg-white hover:bg-opacity-30 rounded-xl transition-all duration-300 hover:scale-110 transform",title:"×™×•× ×”×‘× (××§×© ×—×¥ ×©×××œ×”)",children:e.jsx($e,{size:24,className:"md:w-7 md:h-7"})})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 w-full md:w-auto flex-wrap",children:[(a.role==="××¤"||a.role==="××"||a.role==="××›")&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:X,disabled:$,className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white px-3 py-2 rounded-lg transition-all flex items-center gap-2 shadow-lg disabled:opacity-50 text-sm md:text-base",title:"×™×¦×™×¨×ª ×©×™×‘×•×¥ ×—×›× ×¢× AI",children:$?e.jsxs(e.Fragment,{children:[e.jsx(q,{size:18,className:"animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"××™×™×¦×¨..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"×©×™×‘×•×¥ AI"})]})}),e.jsx("button",{onClick:()=>W(!0),className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",title:"×”×¢×œ×” ×“×•×’×××•×ª ×©×™×‘×•×¥",children:e.jsx(Q,{size:20,className:"md:w-6 md:h-6"})})]}),e.jsx("button",{onClick:()=>J(!0),className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",title:"××™×œ×•×¦×™× ×•×¤×™×“×‘×§",children:e.jsx(Ee,{size:20,className:"md:w-6 md:h-6"})}),e.jsx("button",{onClick:je,className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",title:"×™×™×¦× ×œ×ª××•× ×”",children:e.jsx(De,{size:20,className:"md:w-6 md:h-6"})}),e.jsx("button",{onClick:()=>S(i),className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",title:"×¨×¢× ×Ÿ",disabled:w,children:e.jsx(q,{size:20,className:`md:w-6 md:h-6 ${w?"animate-spin":""}`})})]})]})}),u&&e.jsx("div",{className:"card bg-gradient-to-r from-blue-50 to-purple-50 border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-5 h-5 text-blue-600"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:["×“×™×¨×•×’ ××™×©×•×¨: ",(se=u.approval_rate)==null?void 0:se.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-5 h-5 text-purple-600"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:["×“×¤×•×¡×™× ×©× ×œ××“×•: ",u.patterns_learned]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5 text-green-600"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:['×¡×”"×› ×©×™×‘×•×¦×™×: ',u.total_assignments]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5 text-emerald-600"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:["××•×©×¨×•: ",u.user_approvals]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-red-600"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:["× ×“×—×•: ",u.user_rejections]})]})]})}),k&&e.jsx("div",{className:"card bg-gradient-to-r from-orange-50 to-yellow-50 border-l-4 border-orange-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"w-6 h-6 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:"××©×™××” × ×“×—×ª×” - ×¨×•×¦×” ×œ×©×‘×¥ ×™×“× ×™×ª?"}),e.jsx("p",{className:"text-sm text-gray-600",children:"×©×™×‘×•×¥ ×™×“× ×™ ×™×©××© ×›×“×•×’××” ×œ××¢×¨×›×ª ×•×™×©×¤×¨ ××ª ×”×œ××™×“×”"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>_(!0),className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(Z,{size:18}),e.jsx("span",{children:"×©×‘×¥ ×™×“× ×™×ª"})]}),e.jsx("button",{onClick:()=>I(null),className:"text-gray-600 hover:text-gray-800 px-3",children:"âœ•"})]})]})}),L&&e.jsx("div",{className:"card bg-gradient-to-r from-green-50 to-emerald-50 border-l-4 border-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-500 bg-opacity-20 p-2 rounded-full",children:e.jsx(q,{className:"w-5 h-5 text-green-600 animate-spin"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-bold text-green-800",children:["××™×˜×¨×¦×™×” #",L.number," - ×”×©×™×‘×•×¥ ×©×•×¤×¨!"]}),e.jsxs("div",{className:"text-xs text-green-600",children:["××—×•×– ×”×¦×œ×—×”: ",L.successRate]})]})]}),e.jsx("button",{onClick:()=>me(null),className:"text-green-600 hover:text-green-800 text-sm",children:"âœ•"})]})}),e.jsx("div",{className:"card bg-blue-50 border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-700",children:[e.jsx("kbd",{className:"px-2 py-1 bg-white border border-blue-300 rounded text-sm",children:"â†"}),e.jsx("span",{children:"×™×•× ×”×‘×"}),e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsx("kbd",{className:"px-2 py-1 bg-white border border-blue-300 rounded text-sm",children:"â†’"}),e.jsx("span",{children:"×™×•× ×§×•×“×"})]})}),w?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx("div",{className:"spinner mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"×˜×•×¢×Ÿ ×©×™×‘×•×¥..."})]}):((te=l==null?void 0:l.assignments)==null?void 0:te.length)===0?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx(M,{className:"w-16 h-16 text-purple-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-2",children:"××™×Ÿ ××©×™××•×ª ×œ×™×•× ×–×”"}),e.jsx("p",{className:"text-gray-500 mb-4",children:'×œ×—×¥ ×¢×œ "×©×™×‘×•×¥ AI" ×›×“×™ ×œ×™×¦×•×¨ ×©×™×‘×•×¥ ×—×›× ××•×˜×•××˜×™'}),(a.role==="××¤"||a.role==="××"||a.role==="××›")&&e.jsxs("button",{onClick:X,disabled:$,className:"btn-primary inline-flex items-center gap-2",children:[e.jsx(M,{size:20}),e.jsx("span",{children:"×™×¦×™×¨×ª ×©×™×‘×•×¥ ×—×›×"})]})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["×œ×•×— ×©×¢×•×ª - ",ee(i)]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[(ae=l==null?void 0:l.assignments)==null?void 0:ae.length," ××©×™××•×ª"]})]}),e.jsx("div",{className:"overflow-x-auto",id:"schedule-grid",children:(()=>{var x,f;let s=ge;const t=[...new Set(((x=l==null?void 0:l.assignments)==null?void 0:x.map(c=>c.name))||[])].sort();if(!s||s.length===0)s=t;else{const c=t.filter(b=>!s.includes(b));c.length>0&&(s=[...s,...c]),s=s.filter(b=>t.includes(b))}const r={};s.forEach(c=>{r[c]=[]}),(f=l==null?void 0:l.assignments)==null||f.forEach(c=>{r[c.name]||(r[c.name]=[]),r[c.name].push(c)});const n=Array.from({length:24},(c,b)=>b);return e.jsx(Be,{sensors:fe,collisionDetection:Pe,onDragEnd:be,children:e.jsxs("div",{className:"min-w-max",children:[e.jsxs("div",{className:"flex border-b-2 border-gray-300 mb-2",children:[e.jsx("div",{className:"w-20 flex-shrink-0 font-bold text-gray-700 p-2",children:"×©×¢×”"}),e.jsx(Te,{items:s,strategy:Oe,children:s.map(c=>e.jsx(ss,{name:c},c))})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-20 flex-shrink-0",children:n.map(c=>e.jsxs("div",{className:"h-12 flex items-center justify-center border-b border-gray-200 text-sm text-gray-600 font-medium",children:[c.toString().padStart(2,"0"),":00"]},c))}),s.map(c=>{var b;return e.jsxs("div",{className:"flex-1 min-w-[200px] border-l border-gray-300 relative",children:[n.map(d=>e.jsx("div",{className:"h-12 border-b border-gray-200"},d)),e.jsx("div",{className:"absolute inset-0",children:(b=r[c])==null?void 0:b.map(d=>{const H=d.start_hour||0,le=d.length_in_hours||1,Ce=H+le,K=ke(d),_e=H/24*100,Ae=le/24*100,G=A&&A.id===d.id,Ie=G?"ring-4 ring-yellow-500 shadow-yellow-500/50 animate-pulse":"";return e.jsx("div",{className:`absolute rounded-lg shadow-md overflow-visible group cursor-pointer hover:shadow-lg transition-all duration-200 hover:scale-[1.02] transform border ${Ie}`,style:{top:`calc(${_e}% + 2px)`,height:`calc(${Ae}% - 4px)`,left:"6px",right:"6px",background:`linear-gradient(135deg, ${K} 0%, ${K}dd 100%)`,borderColor:K},children:e.jsxs("div",{className:"p-2 h-full flex flex-col text-white backdrop-blur-sm relative",children:[(a.role==="××¤"||a.role==="××")&&e.jsx("button",{onClick:j=>ve(d,j),className:`absolute bottom-1 right-1 rounded-md p-1.5 transition-all duration-200 z-10 pointer-events-auto shadow-lg ${G?"bg-yellow-500 text-white animate-pulse scale-110":"bg-white/40 hover:bg-yellow-400 hover:text-white opacity-70 hover:opacity-100 hover:scale-105"}`,title:G?"×œ×—×¥ ×©×•×‘ ×œ×‘×™×˜×•×œ ××• ×œ×—×¥ ×¢×œ ××©×™××” ××—×¨×ª ×œ×”×—×œ×¤×”":"×”×—×œ×£ ××©×™××” ×–×• ×¢× ××—×¨×ª",children:e.jsx(He,{className:"w-3.5 h-3.5"})}),(a.role==="××¤"||a.role==="××"||a.role==="××›")&&e.jsxs("div",{className:"absolute top-1 left-1 z-10 flex gap-1 pointer-events-auto",children:[e.jsx("button",{onClick:j=>{j.stopPropagation(),O(d.id,"approved")},className:"bg-gradient-to-br from-green-400 to-emerald-600 hover:from-green-500 hover:to-emerald-700 text-white p-1.5 rounded-full shadow-lg transition-all duration-200 hover:scale-110 transform",title:"××™×©×•×¨ ×©×™×‘×•×¥ - ×”××¢×¨×›×ª ×ª×œ××“ ××”×¤×™×“×‘×§",children:e.jsx(ie,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:j=>{j.stopPropagation(),O(d.id,"rejected")},className:"bg-gradient-to-br from-red-400 to-rose-600 hover:from-red-500 hover:to-rose-700 text-white p-1.5 rounded-full shadow-lg transition-all duration-200 hover:scale-110 transform",title:"×“×—×™×™×ª ×©×™×‘×•×¥ - ×”××¢×¨×›×ª ×ª×œ××“ ××”×¤×™×“×‘×§",children:e.jsx(ce,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:j=>{j.stopPropagation(),B(d),_(!0)},className:"bg-gradient-to-br from-blue-400 to-blue-600 hover:from-blue-500 hover:to-blue-700 text-white p-1.5 rounded-full shadow-lg transition-all duration-200 hover:scale-110 transform",title:"×¢×¨×•×š ××©×™××”",children:e.jsx(Z,{className:"w-3.5 h-3.5"})})]}),e.jsxs("div",{className:"font-bold text-sm mb-1 flex items-center gap-1.5",children:[e.jsx(es,{className:"w-3.5 h-3.5"}),d.name]}),e.jsxs("div",{className:"text-xs opacity-95 mb-1.5 font-medium bg-black bg-opacity-20 rounded px-1.5 py-0.5 inline-block",children:[H.toString().padStart(2,"0"),":00 - ",Ce.toString().padStart(2,"0"),":00"]}),d.soldiers&&d.soldiers.length>0&&e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"space-y-1",children:d.soldiers.map(j=>e.jsxs("div",{className:"text-xs bg-white/25 backdrop-blur-md px-2 py-1 rounded border border-white/30 shadow-sm hover:bg-white/35 transition-all duration-200",children:[e.jsxs("div",{className:"font-semibold flex items-center gap-1",children:[e.jsx(ne,{className:"w-2.5 h-2.5"}),j.name]}),e.jsx("div",{className:"text-[10px] opacity-90 font-medium",children:j.role_in_assignment})]},j.id))})}),(!d.soldiers||d.soldiers.length===0)&&e.jsx("div",{className:"text-xs opacity-80 italic bg-red-500/30 px-2 py-1 rounded border border-red-400/50",children:"××™×Ÿ ×—×™×™×œ×™× ××©×•×‘×¦×™×"})]})},d.id)})})]},c)})]})]})})})()})]})}),U&&e.jsx(ts,{onClose:()=>W(!1),onUploadSuccess:()=>{C(),h.success("âœ… ×“×•×’×××•×ª ×”×•×¢×œ×• ×‘×”×¦×œ×—×” - ×”××•×“×œ ××©×ª×¤×¨!")}}),ue&&e.jsx(as,{onClose:()=>{P(!1),T(null)},onSubmit:s=>{O(pe,"rejected",s),P(!1),T(null)}}),xe&&e.jsx(Ke,{onClose:()=>J(!1),onUpdate:()=>{S(i),C()}}),he&&(k||F)&&e.jsx(Ge,{assignment:k||F,date:i,dayIndex:(re=k||F)==null?void 0:re.day,shavzakId:D,plugaId:a.pluga_id,onClose:()=>{_(!1),I(null),B(null)},onSave:Ne})]})},ts=({onClose:a,onUploadSuccess:i})=>{const[g,l]=o.useState(!1),[p,v]=o.useState([]),y=m=>{const u=Array.from(m.target.files);v(u)},w=async()=>{if(p.length===0){h.error("×‘×—×¨ ×œ×¤×—×•×ª ×§×•×‘×¥ ××—×“");return}l(!0);try{for(const m of p){const u=new FileReader,R=await new Promise(U=>{u.onloadend=()=>U(u.result),u.readAsDataURL(m)});await N.post("/ml/upload-example",{image:R,rating:"good"})}h.success(`âœ… ×”×•×¢×œ×• ${p.length} ×“×•×’×××•×ª!`),i(),a()}catch(m){h.error("×©×’×™××” ×‘×”×¢×œ××ª ×“×•×’×××•×ª"),console.error("Upload error:",m)}finally{l(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-lg w-full shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Q,{className:"w-6 h-6 text-purple-600"}),"×”×¢×œ××ª ×“×•×’×××•×ª ×©×™×‘×•×¥"]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"×”×¢×œ×” ×ª××•× ×•×ª ×©×œ ×©×™×‘×•×¦×™× ×™×“× ×™×™× ×˜×•×‘×™× - ×”××¢×¨×›×ª ×ª×œ××“ ××”×!"}),e.jsxs("div",{className:"border-2 border-dashed border-purple-300 rounded-lg p-6 text-center bg-purple-50",children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:y,className:"hidden",id:"file-upload"}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center gap-2",children:[e.jsx(Q,{className:"w-12 h-12 text-purple-400"}),e.jsx("span",{className:"text-purple-600 font-medium",children:"×œ×—×¥ ×œ×‘×—×™×¨×ª ×§×‘×¦×™×"}),e.jsx("span",{className:"text-sm text-gray-500",children:"×ª××•× ×•×ª, PDF ××• Excel"})]})]}),p.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:["× ×‘×—×¨×• ",p.length," ×§×‘×¦×™×:"]}),e.jsx("div",{className:"space-y-1",children:p.map((m,u)=>e.jsx("div",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded",children:m.name},u))})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:w,disabled:g||p.length===0,className:"flex-1 btn-primary disabled:opacity-50",children:g?"××¢×œ×”...":"×”×¢×œ×” ×•×”×××Ÿ"}),e.jsx("button",{onClick:a,className:"flex-1 btn-secondary",children:"×‘×™×˜×•×œ"})]})]})})},as=({onClose:a,onSubmit:i})=>{const[g,l]=o.useState(""),[p,v]=o.useState(""),y=["×—×™×™×œ×™× ×œ× ××ª××™××™×","×¢×¨×‘×•×‘ ××—×œ×§×•×ª","×ª×–××•×Ÿ ×œ× ×˜×•×‘","×—×•×¡×¨ ×‘××¤×§×“×™×/× ×”×’×™×","××—×¨"],w=()=>{const m=g==="××—×¨"?p:g;m&&i(m)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[70] p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"×œ××” ×”×©×™×‘×•×¥ ×œ× ×˜×•×‘?"}),e.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:"×”×¡×‘×¨ ×§×¦×¨ ×™×¢×–×•×¨ ×œ××¢×¨×›×ª ×œ×œ××•×“ ×•×œ×”×©×ª×¤×¨ ×œ×¤×¢× ×”×‘××”."}),e.jsx("div",{className:"space-y-2 mb-4",children:y.map(m=>e.jsxs("label",{className:"flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"reason",value:m,checked:g===m,onChange:u=>l(u.target.value),className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"text-gray-700",children:m})]},m))}),g==="××—×¨"&&e.jsx("textarea",{value:p,onChange:m=>v(m.target.value),placeholder:"×¤×¨×˜ ××ª ×”×¡×™×‘×”...",className:"w-full p-3 border rounded-lg mb-4 focus:ring-2 focus:ring-purple-500 outline-none",rows:3}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:w,disabled:!g||g==="××—×¨"&&!p,className:"flex-1 btn-primary",children:"×©×œ×— ×¤×™×“×‘×§"}),e.jsx("button",{onClick:a,className:"flex-1 btn-secondary",children:"×‘×™×˜×•×œ"})]})]})})};export{xs as default};
